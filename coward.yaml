# example invocations:
#   coward all
#   coward snapshot
#   coward snapshot:rootfs
#   coward snapshot:rootfs,home
#   coward snapshot prune push
#   coward snapshot:rootfs prune:home
# optionally use -c <path> to specify a non-default config file

snapshot:
    rootfs:
        src:        /btrfs/@rootfs
        dest:       /btrfs/snapshots/rootfs/%F_%T_%a
        readonly:   true
    home:
        src:        /btrfs/@home
        dest:       /btrfs/snapshots/home/%F_%T_%a
        readonly:   true

prune:
    rootfs:
        mountpoint:     /btrfs
        dir:            snapshots/rootfs
        keep:
            .+_08:.*:           8
            .+_(02|14|20):.*:   9

    epsilon:
        mountpoint:     /mnt/btr-backup
        dir:            snapshots/epsilon/rootfs/
        keep:
            # hourly:
            .+_(02|14|20):.*:                          9
            # daily:
            .+_08:.*:                                  8
            # weekly:
            .+_08:..:.._Tue.*:                         9
            # monthly:
            \d{4}-\d{2}-0[1-7]_08:\d{2}:\d{2}_Tue:    999

    xi:
        mountpoint:     /mnt/btr-backup
        dir:            snapshots/xi/rootfs/
        keep:
            # hourly:
            .+_(02|14|20):.*:                          9
            # daily:
            .+_08:.*:                                  8
            # weekly:
            .+_08:..:.._Tue.*:                         9
            # monthly:
            \d{4}-\d{2}-0[1-7]_08:\d{2}:\d{2}_Tue:    999


push:
    rootfs:
        # copy the <n> latest snapshots that match the regex
        selection-regex:    .+
        selection-count:    1
        incremental:        true
        src-mountpoint:     /btrfs
        src-dir:            snapshots/rootfs/
        dest-server:        backup.voidptr.de
        dest-path:          /btrfs/snapshots/zeta/rootfs/
    test:
        # copy the <n> latest snapshots that match the regex
        selection-regex:    \.r
        selection-count:    1
        #incremental:        true
        src-mountpoint:     /mnt/wd3
        src-dir:            
        dest-server:        phi
        dest-path:          /mnt/btr-backup/test/

pull:
    rootfs:
        # copy the <n> latest snapshots that match the regex
        selection-regex:    /\d{4}-
        selection-count:    1
        #incremental:        true
        src-server:         phi
        src-mountpoint:     /mnt/btr-backup
        src-dir:            snapshots/epsilon/rootfs/
        dest-path:          /btrfs/snapshots/zeta/rootfs/
    test:
        # copy the <n> latest snapshots that match the regex
        selection-regex:    \.r
        selection-count:    1
        #incremental:        true
        src-server:         phi
        src-mountpoint:     /mnt/btr-backup
        src-dir:            test/
        dest-path:          /mnt/wd3/
